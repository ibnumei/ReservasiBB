@*@model IEnumerable<ReservBigBird.API_Model.AfterPostTerimaOrder>*@
@using ReservBigBird.API_Model;

@if (ViewBag.ResulData != null)
{
    <table class="table table-bordered table-striped" id="TableHasil">
        <thead>
            <tr>
                <th>Jenis</th>
                <th>AC</th>
                <th>Pool</th>
                <th>Tgl Awal</th>
                <th>Jam Awal</th>
                <th>Tgl Akhir</th>
                <th>Jam Akhir</th>
                <th>Jmlh</th>
                <th>Tgl Trans</th>
                <th>Jam Trans</th>
                <th>Kel Tujuan</th>
                <th>Delete</th>
            </tr>
        </thead>
        <tbody>
            @foreach (AfterPostTerimaOrder afterPostTerimaOrder in ViewBag.ResulData)
            {
                <tr>
                    <td class="Jenis">@afterPostTerimaOrder.JNBID</td>
                    <td class="AC">@afterPostTerimaOrder.JNBAC</td>
                    <td class="Pool">@afterPostTerimaOrder.POLID</td>
                    <td class="TglAwal">@afterPostTerimaOrder.SBSTAW</td>
                    <td class="JamAwal">@afterPostTerimaOrder.SBSJAW</td>
                    <td class="TglAkhir">@afterPostTerimaOrder.SBSTAK</td>
                    <td class="JamAkhir">@afterPostTerimaOrder.SBSJAK</td>
                    <td class="Jumlah">@afterPostTerimaOrder.SBSJB</td>
                    <td class="TglTrans">@afterPostTerimaOrder.SBSTAS</td>
                    <td class="JamTrans">@afterPostTerimaOrder.SBSJAS</td>
                    <td class="KelTujuan">@afterPostTerimaOrder.KTJID</td>
                    <td class="btn btn-default" id="btnDel"><a onclick="deleteRow(this)">Delete</a></td>
                </tr>
            }
        </tbody>
    </table>

    <script>
        $('#ModalSmall').modal('hide');
    </script>
}
    <script>
        var a, b, c, d, e, f, g, h, i, j, k;
        var param;
        function deleteRow(r) {
            param = r.parentNode.parentNode.rowIndex;
            console.log(param);
        }
        $('#TableHasil tbody').on('click', '#btnDel', function () {
            var currow = $(this).closest('tr');
            console.log(currow);
            
            a = $.trim(currow.find('.Jenis').text());

            b = $.trim(currow.find('.AC').text());

            c = $.trim(currow.find('.Pool').text());
            
            d = $.trim(currow.find('.TglAwal').text());

            e = $.trim(currow.find('.JamAwal').text());

            f = $.trim(currow.find('.TglAkhir').text());

            g = $.trim(currow.find('.JamAkhir').text());

            h = $.trim(currow.find('.Jumlah').text());

            i = $.trim(currow.find('.TglTrans').text());

            j = $.trim(currow.find('.JamTrans').text());

            k = $.trim(currow.find('.KelTujuan').text());

            swal({
            title: "Delete Your Order ?",
            text: "Once deleted, you will not be able to recover your data!",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("Delete")',
                        data: { Jenis: a, AC: b, Pool: c, TglAwal: d, JamAwal: e, TglAkhir: f, JamAkhir: g, KelTujuan: k},
                        dataType: "json",
                      // success: window.location.reload(),
                        success: function (response) {
                            swal("Order Has Been Deleted!", {
                                icon: "success",
                            }).then(function() {
                              //  window.location.href = "/Technician/Index"
                                // window.location.reload()
                                $(this).closest('tr').remove();
                                document.getElementById("TableHasil").deleteRow(param);
                            });
                           
                        },
                        error: function (response) {
                            swal("Error", "Tidak Mendapat Respon dari Server, Silahkan coba lagi", "error")
                        }
                    });
                }
                else {
                    swal("Your data is safe!");
                }
            });
        })

        
    </script>
