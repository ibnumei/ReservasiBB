@model IEnumerable<ReservBigBird.API_Model.MonitorOrder>

@if(Model == null && ViewBag.error == "Tidak Dapat Respon dari Server")
{
    <script>
        swal("Error", "Tidak Mendapat Respon dari Server, Silahkan coba lagi", "error");
        $("#divLoader").hide();
    </script>
}
@if (Model != null)
{

    <h3 class="box-title">Hasil Pencarian</h3>
    <br />
    <div class="table-responsive">

        <table id="example3" class="table table-striped">
            <thead>
                <tr style="background-color:#808080;color:#ffffff;">
                    <th>No Order</th>
                    <th>No Item</th>
                    <th>STS</th>
                    <th>DISC</th>
                    <th>Jenis</th>
                    <th>POOL</th>
                    <th>KEL TUJUAN</th>
                    <th>ALAMAT JEMPUT</th>
                    <th>TGL JEMPUT</th>
                    <th>JAM JEMPUT</th>
                    <th>TGL SELESAI</th>
                    <th>JAM SELESAI</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            <a style="background-color: #e4e4e4; color: #444; border-color: #888484; cursor: pointer;" class="btn btn-sm btn-default" onclick="get('@Html.DisplayFor(modelItem => item.NoOrder)')" id="aidi"><i class="fas fa-trash-alt"></i>  @Html.DisplayFor(modelItem => item.NoOrder) </a>
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.NoItem)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Sts)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Disc)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Jenis)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Pool)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.KelTujuan)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.AlamatJemput)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.TglJemput)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.JamJemput)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.TglSelesei)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.JamSelesei)
                        </td>
                    </tr>
                }

            </tbody>
        </table>
    </div>

    <script>
        $("#divLoader").hide();
    </script>
}

<div id="myModalPopup" class="modal fade bd-example-modal-lg3" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">

                <div id="divLoader2" style="display:none;text-align:center"> <img src="~/Content/dist/img/ajax-loader-blue.gif" alt="Loader" /> </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h3 id="JudulModal" class="modal-title" style="text-align:center">Pembayaran</h3>

            </div>

            <div class="modal-body" id="BodyModal">

                <form asp-action="CreateTaskLine">
                    <div class="row form-border">
                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                        <div class="form-group">

                            <div class="col-sm-12">

                                <div class="row">
                                    <div class="col-sm-2">
                                        <b>Jenis Pembayaran</b>
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="JenisPemby" readonly="readonly">
                                    </div>
                                    <div class="col-sm-2">
                                        <b>Tarif Bus</b>
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="TarifBus" readonly="readonly">
                                    </div>
                                </div>
                                <br />

                                <div class="row">
                                    <div class="col-sm-2">
                                        <b>Lebih Bayar</b>
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="LbhBayar" readonly="readonly">
                                    </div>
                                    <div class="col-sm-2">
                                        <b>% Diskon</b>
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="Diskon" readonly="readonly">
                                    </div>
                                </div>
                                <br />

                                <div class="row">
                                    <div class="col-sm-2">
                                        <b>Biaya Pembatalan</b>
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="BiayaPembatalan" readonly="readonly">
                                    </div>
                                    <div class="col-sm-2">
                                        <b>RP Diskon</b>
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="RpDiskon" readonly="readonly">
                                    </div>
                                </div>
                                <br />

                                <div class="row">
                                    <div class="col-sm-2">

                                    </div>
                                    <div class="col-sm-4">

                                    </div>
                                    <div class="col-sm-2">
                                        <b>Total Pembayaran</b>
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="TotalPembayaran" readonly="readonly">
                                    </div>
                                </div>
                                <br />

                                <div class="row">
                                    <div class="col-sm-2">

                                    </div>
                                    <div class="col-sm-4">

                                    </div>
                                    <div class="col-sm-2">
                                        <b>Sudah Dibayar</b>
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="SdhDibayar" readonly="readonly">
                                    </div>
                                </div>
                                <br />

                                <div class="row">
                                    <div class="col-sm-2">

                                    </div>
                                    <div class="col-sm-4">

                                    </div>
                                    <div class="col-sm-2">
                                        <b>Sisa Pembayaran</b>
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="SisaPembyran" readonly="readonly">
                                    </div>
                                </div>
                                <br />

                                <div class="row">
                                    <div class="col-sm-2">

                                    </div>
                                    <div class="col-sm-4">

                                    </div>
                                    <div class="col-sm-2">
                                        <b>PPH 23</b>
                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="pph23" readonly="readonly">
                                    </div>
                                </div>
                                <br />

                                <div class="row">
                                    <div class="col-sm-2">

                                    </div>
                                    <div class="col-sm-4">

                                    </div>
                                    <div class="col-sm-2">

                                    </div>
                                    <div class="col-sm-4">
                                    </div>
                                </div>
                                <br />

                            </div>


                        </div>
                    </div>
                </form>


            </div>

            <div id="ButtonModal" class="modal-footer">
                <button type="button" class="btn btn-warning" data-dismiss="modal">
                    <span class="glyphicon glyphicon-remove"></span>
                    Close
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('#example3').DataTable({
            'paging': true,
            'lengthChange': false,
            'searching': false,
            'ordering': false,
            'info': true,
            'autoWidth': true
        })
    })
</script>

<script type="text/javascript">
    function get(NoOrder1) {

      
        var apiUrl = '@System.Configuration.ConfigurationManager.AppSettings["UrlApi"]';
        //alert(apiUrl);

        var a = $.trim(NoOrder1);

        $("#divLoader2").show();
        $("#BodyModal").hide(); $("#JudulModal").hide(); $("#ButtonModal").hide(); 
        $('#myModalPopup').modal('toggle');

        $.ajax({
            type: "GET",
            url: apiUrl+"/Api/Orders?ordid=" + a + "&ordnpt=&ordnpm=&kondisi=",
            dataType: "json",

            success: function (data) {
                console.log(data);
                $("#divLoader2").hide();
                $.each(data, function (i, item) {

                    if (item.JenisPembayaran == null) { document.getElementById("JenisPemby").value = ""; }
                    else { document.getElementById("JenisPemby").value = item.JenisPembayaran; }

                    if (item.LebihBayar == null) { document.getElementById("LbhBayar").value = ""; }
                    else { document.getElementById("LbhBayar").value = item.LebihBayar; }

                    if (item.BiayaBatal == null) { document.getElementById("BiayaPembatalan").value = ""; }
                    else { document.getElementById("BiayaPembatalan").value = item.BiayaBatal; }

                    if (item.TarifBus == null) { document.getElementById("TarifBus").value = ""; }
                    else { document.getElementById("TarifBus").value = item.TarifBus; }

                    if (item.Disc == null) { document.getElementById("Diskon").value = ""; }
                    else { document.getElementById("Diskon").value = item.Disc; }

                    if (item.RpDiskon == null) { document.getElementById("RpDiskon").value = ""; }
                    else { document.getElementById("RpDiskon").value = item.RpDiskon; }

                    if (item.TotalBayar == null) { document.getElementById("TotalPembayaran").value = ""; }
                    else { document.getElementById("TotalPembayaran").value = item.TotalBayar; }

                    if (item.SudahDibayar == null) { document.getElementById("SdhDibayar").value = ""; }
                    else { document.getElementById("SdhDibayar").value = item.SudahDibayar; }

                    if (item.SisaPembayaran == null) { document.getElementById("SisaPembyran").value = ""; }
                    else { document.getElementById("SisaPembyran").value = item.SisaPembayaran; }

                    if (item.Pph23 == null) { document.getElementById("pph23").value = ""; }
                    else { document.getElementById("pph23").value = item.Pph23; }



                });

                $("#BodyModal").show(); $("#JudulModal").show(); $("#ButtonModal").show(); 
                //$('#myModalPopup').modal('toggle');
            },
            error: function (data) {
                //alert("erorr");
                $('#myModalPopup').modal('hide');
                swal("Error", "Tidak Mendapat Respon dari Server, Silahkan coba lagi", "error")
            }, //
        });
    }
</script>

